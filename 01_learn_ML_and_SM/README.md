# 第1回 新SageMaker勉強会 機械学習系サービスと新SageMakerざっくり

## 第1回の目的

以下の内容を理解します。

- AWSのML系サービスにはどんなものがあるか？
- SageMakerとはどんなサービスであったか？
- どんどん増えるAWSのML系サービスの中でのSageMakerの位置づけは？
- どんなときにどのサービスを選択すればよいか？
- インフラという観点でSageMakerのどの機能を押さえておくべきか？

以下についてはお話しません。

- AI, 機械学習とは何か？
- 各サービスの具体的な仕様・利用方法

# 1. AWSのML系サービスおさらい

これを見てくれ

- [AWS での機械学習](https://aws.amazon.com/jp/machine-learning/)

2つに分けてるらしい。。。

|||
|---|---|
|AIサービス |その名の通り。APIでInputを与えると予測結果が返ってくる感じのサービス群。機械学習の知識がなくともアプリケーションに機能を追加できる。しかしサービス・機能によってはユーザーが学習データを用意する必要がある。|
|MLサービス|ユーザーが学習データを用意→トレーニング→ホスティングまでするサービス。どちらかというとデータサイエンティストのためのサービス。いまのところSageMakerだけらしい。|

# 2. SageMakerおさらい

これを見てくれ

- [Amazon SageMaker](https://aws.amazon.com/jp/sagemaker/)

## 2-1. SageMakerを分けてみてみる。。。

ざっくり以下の要素にわけられる

1. 開発環境
2. ラベリング
3. トレーニング
4. ホスティング
5. レビュー

それぞれ機械学習, AIの運用の各フェーズを担ってる。

[画像01]

しかし、重要な機能は1, 3, 4な感じ(個人の感想)

1-5に属する細かい機能もいっぱいある。それは今後の各論で。

それぞれ見てみる

### 2-1-1. 開発環境

SageMaker Studioと呼ばれるやつ。

特徴（詳しくは次回）

- マネージドなJupyterLab
- 起動が早い
- もろもろのライブラリがインストール済み
- 課金体系

などなど

SageMaker Studio上でデータを前処理したり、↓で説明するトレーニングやホスティングの実行したりする感じ。

IAMユーザー払い出し・ライブラリインストールの手間はかかるが、トレーニングやホスティングの実行だけならローカルやGoogleColaboratoryでもできなくはないとお考えか？SageMaker StudioはAWS SSOが使えるし、Studio自体にIAMロールがつくよ（詳しくは次回）

### 2-1-2. 学習データのラベリング

Groud Truth

- S3に保存したデータをラベリングするための画面が用意されてる。
- ラベリングする人員はMechanical Turk, サードパーティ, プライベートが選べる。

### 2-1-3. モデルのトレーニング

SageMakerの主要な機能の1つ。

マネージドなインスタンスを使ってモデルの学習ができるので、ほとんどインフラを気にする必要がない。

インスタンスは「トレーニングジョブ」ごとに立ち上がり、ジョブが完了すると勝手に停止する。ユーザーは実行したら待ってればよい。

インスタンスと言ってるけど、Dockerで動いてる。

- 組み込みアルゴリズムと呼ばれるAWSマネージドなアルゴリズムが用意されてる。
- トレーニングで利用できるディープラーニングフレームワークを含んだマネージドなDockerイメージも提供されてる。TensorFlowとかPytorchとか。
- Dockerイメージを用意するればアルゴリズムを持ち込むこともできる。

ExperimentやDebugger, ハイパーパラメータ調整などの便利機能もある。詳しくは今後の各論で。

### 2-1-4. モデルのホスティング

SageMakerの主要な機能の1つ。

マネージドなインスタンスを使ってトレーニングしたモデルのホスティングできるので、ほとんどインフラを気にする必要がない。

インスタンスと言ってるけど、Dockerで動いてる。



### 2-1-5. レビュー

Argumented AI

- 知らなくてもよい。

## 2-2. 全て利用しないといけないわけではない

SageMakerでトレーニングしたモデルとそれに関連するファイルはS3に吐かれる, 吐くことができる。そのためこれを別のところに持っていくことも可能。

[画像2]

モデルのホスティングではS3に置いたモデルとそれに関連するファイルを指定する。つまり別の環境でトレーニングしたモデルをS3に置けばホスティングのみも可能。

[画像3]

- マネージドなので、トレーニング~ホスティングまでSageMakerでいいように思える。
- 要件によってはトレーニングのみSageMakerということもある。もしくはホスティングのみSageMakerというのもできる。

## 2-3. SageMakerだけで完結するわけではない

SageMakerのみでやるとしても。。。

- 学習データはS3に置く
- ホスティングしたエンドポイントを叩くLambdaを用意。

MLOps的な話で自動化しようと思うと。。。

- Code兄弟でがんばる？

# 3. どのサービスをつかおうか？

考えてみよう

1. ある企業はカメラで撮った画像から物体検出をするモバイルアプリを開発しようとしています。どのAWSサービスを使うとよいでしょう？
2. ある企業は運営する動画配信サイトにユーザーに対するレコメンデーション機能を追加したいと考えています。どのAWSサービスを使うとよいでしょう？
3. 
3. ある企業は自社の工場で画像認識で検品する仕組みを作りたいと考えています。どのAWSサービスを使うとよいでしょう？
4. ある企業は経営する700店舗のレストランの売上を店舗ごとに予測したい。どのAWSサービスを使うとよいでしょう？

# 4. インフラ担当から見たSageMaker

インフラ担当から見た、というかリセラーから見た、CIerから見たというべきか。。。

- ネットワークの管理がほぼない。VPCに接続とかしなければ。
- IAMの管理は必要。IAMロール, AWS SSOも。

料金の話でいうと、気にすべき機能は↓。インスタンスが立ち上がる=料金が発生する。

- Processing
- トレーニング
    - パラメータ調整
- ホスティング

ちなみに料金は、通常のEC2インスタンスより割高。


料金をケチって別の構成を取るのもいいが、要件に合うならだいたいはSageMakerでいいとオモウ。
